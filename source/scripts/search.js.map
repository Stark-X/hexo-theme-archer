{"version":3,"sources":["webpack://hexo-theme-archer/./src/js/search.js"],"names":["$","document","ready","algoliaSettings","algolia","applicationID","apiKey","indexName","searchClient","algoliasearch","search","instantsearch","searchFunction","helper","searchInput","find","querySelector","style","display","state","query","val","stalledSearchDelay","widgets","searchBox","container","placeholder","labels","input_placeholder","showSubmit","showReset","showLoadingIndicator","hits","hitsPerPage","per_page","templates","item","data","permalink","siteMeta","root","path","highlight","attribute","hit","highlightedTagName","empty","hits_empty","replace","cssClasses","list","emptyRoot","stats","text","hits_stats","nbHits","processingTimeMS","pagination","scrollTo","first","last","previous","next","forEach","addWidget","start","on","e","stopPropagation","prepend","css","toggle","focus","hidePopup","trigger","hide","remove","click","event","key","window","console","error"],"mappings":"AAEEA,EAAEC,UAAUC,OAAM,WAChB,IAAMC,EAAkBC,QAMxB,GAJED,EAAgBE,eAChBF,EAAgBG,QAChBH,EAAgBI,UAElB,CAKA,IAAMC,EAAeC,cACnBN,EAAgBE,cAChBF,EAAgBG,QAGZI,EAASC,cAAc,CAC3BJ,UAAWJ,EAAgBI,UAC3BC,eACAI,eAAgB,SAAUC,GACxB,IAAIC,EAAcd,EAAE,yBAAyBe,KAAK,SAEhCd,SAASe,cAAc,oBAC/BC,MAAMC,QAAiC,KAAvBL,EAAOM,MAAMC,MAAe,OAAS,GAC3DN,EAAYO,OACdR,EAAOH,UAGXY,mBAAoB,MAIrB,CACCX,cAAcY,QAAQC,UAAU,CAC9BC,UAAW,wBACXC,YAAavB,EAAgBwB,OAAOC,kBACpCC,YAAY,EACZC,WAAW,EACXC,sBAAsB,IAGxBpB,cAAcY,QAAQS,KAAK,CACzBP,UAAW,gBACXQ,YAAa9B,EAAgB6B,KAAKE,UAAY,GAC9CC,UAAW,CACTC,KAAM,SAAUC,GAId,MACE,aAJSA,EAAKC,UACZD,EAAKC,UACLC,SAASC,KAAOH,EAAKI,MAIvB,mCACA9B,cAAc+B,UAAU,CACtBC,UAAW,QACXC,IAAKP,EACLQ,mBAAoB,OAEtB,QAGJC,MAAO,SAAUT,GACf,MACE,sFAEAlC,EAAgBwB,OAAOoB,WAAWC,QAChC,cACAX,EAAKjB,OAEP,WAIN6B,WAAY,CACVb,KAAM,mBACNc,KAAM,mBACNV,KAAM,cACNW,UAAW,uBAIfxC,cAAcY,QAAQ6B,MAAM,CAC1B3B,UAAW,iBACXU,UAAW,CACTkB,KAAM,SAAUhB,GAId,OAHYlC,EAAgBwB,OAAO2B,WAChCN,QAAQ,aAAcX,EAAKkB,QAC3BP,QAAQ,aAAcX,EAAKmB,kBAE5BJ,6CAGAb,SAASC,KAHTY,2DAUNH,WAAY,CACVT,KAAM,uBAIV7B,cAAcY,QAAQkC,WAAW,CAC/BhC,UAAW,sBACXiC,UAAU,EACVvB,UAAW,CACTwB,MAAO,0CACPC,KAAM,2CACNC,SAAU,mCACVC,KAAM,wCAGVC,QAAQrD,EAAOsD,UAAWtD,GAE5BA,EAAOuD,QAEPjE,EAAE,kBAAkBkE,GAAG,SAAS,SAAUC,GACxCA,EAAEC,kBACFpE,EAAE,QACCqE,QAAQ,gEACRC,IAAI,WAAY,UACnBtE,EAAE,UAAUuE,SACZvE,EAAE,yBAAyBe,KAAK,SAASyD,WAG3C,IAAMC,EAAY,WAChBzE,EAAE,uBAAuB0E,QAAQ,SACjC1E,EAAE,UAAU2E,OACZ3E,EAAE,wBAAwB4E,SAC1B5E,EAAE,QAAQsE,IAAI,WAAY,KAG5BtE,EAAE,oBAAoB6E,OAAM,WAC1BJ,OAGFzE,EAAEC,UAAUiE,GAAG,UAAW,uBAAuB,SAAUY,GACvC,WAAdA,EAAMC,KACRN,YArIFO,OAAOC,QAAQC,MAAM","file":"search.js","sourcesContent":["// special thanks to https://blog.naaln.com/2016/07/hexo-with-algolia/\nconst initAlgolia = () => {\n  $(document).ready(function () {\n    const algoliaSettings = algolia\n    const isAlgoliaSettingsValid =\n      algoliaSettings.applicationID &&\n      algoliaSettings.apiKey &&\n      algoliaSettings.indexName\n\n    if (!isAlgoliaSettingsValid) {\n      window.console.error('Algolia Settings are invalid.')\n      return\n    }\n\n    const searchClient = algoliasearch(\n      algoliaSettings.applicationID,\n      algoliaSettings.apiKey\n    )\n\n    const search = instantsearch({\n      indexName: algoliaSettings.indexName,\n      searchClient,\n      searchFunction: function (helper) {\n        let searchInput = $('#algolia-search-input').find('input')\n\n        const container = document.querySelector('.algolia-results')\n        container.style.display = helper.state.query === '' ? 'none' : ''\n        if (searchInput.val()) {\n          helper.search()\n        }\n      },\n      stalledSearchDelay: 500,\n    })\n\n    // Registering Widgets\n    ;[\n      instantsearch.widgets.searchBox({\n        container: '#algolia-search-input',\n        placeholder: algoliaSettings.labels.input_placeholder,\n        showSubmit: false,\n        showReset: false,\n        showLoadingIndicator: false,\n      }),\n\n      instantsearch.widgets.hits({\n        container: '#algolia-hits',\n        hitsPerPage: algoliaSettings.hits.per_page || 10,\n        templates: {\n          item: function (data) {\n            let link = data.permalink\n              ? data.permalink\n              : siteMeta.root + data.path\n            return (\n              '<a href=\"' +\n              link +\n              '\" class=\"algolia-hit-item-link\">' +\n              instantsearch.highlight({\n                attribute: 'title',\n                hit: data,\n                highlightedTagName: 'em',\n              }) +\n              '</a>'\n            )\n          },\n          empty: function (data) {\n            return (\n              '<i class=\"fas fa-drafting-compass fa-10x\"></i>' +\n              '<div class=\"algolia-hit-empty-label\">' +\n              algoliaSettings.labels.hits_empty.replace(\n                /\\$\\{query\\}/,\n                data.query\n              ) +\n              '</div>'\n            )\n          },\n        },\n        cssClasses: {\n          item: 'algolia-hit-item',\n          list: 'algolia-hit-list',\n          root: 'algolia-hit',\n          emptyRoot: 'algolia-hit-empty',\n        },\n      }),\n\n      instantsearch.widgets.stats({\n        container: '#algolia-stats',\n        templates: {\n          text: function (data) {\n            let stats = algoliaSettings.labels.hits_stats\n              .replace(/\\$\\{hits\\}/, data.nbHits)\n              .replace(/\\$\\{time\\}/, data.processingTimeMS)\n            return (\n              stats +\n              '<span class=\"algolia-powered\">' +\n              '  <img src=\"' +\n              siteMeta.root +\n              'assets/algolia_logo.svg\" alt=\"Algolia\" />' +\n              '</span>' +\n              '<hr />'\n            )\n          },\n        },\n        cssClasses: {\n          root: 'algolia-stat-root',\n        },\n      }),\n\n      instantsearch.widgets.pagination({\n        container: '#algolia-pagination',\n        scrollTo: false,\n        templates: {\n          first: '<i class=\"fa fa-angle-double-left\"></i>',\n          last: '<i class=\"fa fa-angle-double-right\"></i>',\n          previous: '<i class=\"fa fa-angle-left\"></i>',\n          next: '<i class=\"fa fa-angle-right\"></i>',\n        },\n      }),\n    ].forEach(search.addWidget, search)\n\n    search.start()\n\n    $('.popup-trigger').on('click', function (e) {\n      e.stopPropagation()\n      $('body')\n        .prepend('<div class=\"search-popup-overlay algolia-pop-overlay\"></div>')\n        .css('overflow', 'hidden')\n      $('.popup').toggle()\n      $('#algolia-search-input').find('input').focus()\n    })\n\n    const hidePopup = () => {\n      $('.ais-SearchBox-form').trigger('reset')\n      $('.popup').hide()\n      $('.algolia-pop-overlay').remove()\n      $('body').css('overflow', '')\n    }\n\n    $('.popup-btn-close').click(function () {\n      hidePopup()\n    })\n\n    $(document).on('keydown', '.ais-SearchBox-form', function (event) {\n      if (event.key === 'Escape') {\n        hidePopup()\n      }\n    })\n  })\n}\n\ninitAlgolia()\n"],"sourceRoot":""}